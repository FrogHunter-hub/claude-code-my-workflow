# CLAUDE.MD -- Academic Research Project with Claude Code

**Project:** Managerial Theories of Technology
**Institution:** Frankfurt School of Finance & Management
**Authors:** Xingxu Chai, Ruishen Zhang (HKU), Laurence van Lent, Menghan Zhu (VU Amsterdam)
**Branch:** main
**Last updated:** 2026-02-13

---

## Core Principles

- **Plan first** -- enter plan mode before non-trivial tasks; save plans to `quality_reports/plans/`
- **Verify after** -- compile/run and confirm output at the end of every task
- **Single source of truth** -- Overleaf `.tex` is the authoritative manuscript; all tables/figures are generated by code
- **Quality gates** -- nothing ships below 80/100
- **[LEARN] tags** -- when corrected, save `[LEARN:category] wrong → right` to MEMORY.md

---

## Platform & Environment

- **OS:** Windows 11 Home China (10.0.26100)
- **Shell:** PowerShell (all scripts `.ps1`; bash stubs redirect)
- **Python:** 3.11 via conda env `Technology` at `D:\anaconda\envs\Technology\python.exe`
- **Stata:** StataSE 19.5 at `D:\StataSE-64.exe` (env var: `STATA_EXE`)
- **LaTeX:** Overleaf (remote); local pdflatex available for verification
- **Editor:** VS Code with Claude Code panel
- **Encoding fix:** Windows GBK default breaks Unicode output. Prefix Python commands with `set PYTHONIOENCODING=utf-8 &&` or use `conda run` with `PYTHONIOENCODING=utf-8` env var.

---

## Folder Structure

```
Managerial-Theories-of-Technology/
├── CLAUDE.md                        # This file
├── MEMORY.md                        # Persistent corrections and learned facts
├── STARTER_PROMPT.md                # First-session onboarding prompt
├── .claude/                         # Rules, skills, agents, hooks
├── Overleaf/                        # Manuscript LaTeX source (SSOT)
│   ├── main.tex                     # Main paper
│   ├── references.bib               # Bibliography
│   ├── Figures/                     # Generated figures (.pdf + .png)
│   │   └── allfigures.tex           # Figure float environments
│   ├── Tables/                      # Generated tables (.tex)
│   │   └── alltables.tex            # Table input list
│   ├── Appendix/                    # Appendix sections
│   └── Methodology/                 # Appendix methodology docs
├── src/
│   ├── py/                          # Python analysis pipeline
│   │   ├── 01_clean.py              # Raw → panel_ikt.csv
│   │   ├── 02_analysis.py           # (placeholder)
│   │   ├── 03_table_II_summary_stats.py  # Table II
│   │   ├── 04_table_IIIA_top_scoring.py  # Top-scoring transcripts
│   │   ├── 04b_figure_IIIB_techpush_demandpull.py  # Figure II scatter
│   │   ├── 05_figure_II_time_series.py   # Figure III time series
│   │   ├── 06_table_IVB_spillover.py     # Table VI spillover
│   │   ├── 07_table_IVC_dynamics.py      # Table VII + Figure IV
│   │   └── manifest.py              # Run manifest utility
│   └── stata/                       # Stata do-files (regressions)
│       ├── 01_setup.do
│       └── 02_tableV_variance.do    # Table V variance decomposition
├── data/                            # Raw inputs (read-only, not in git)
├── data_processed/                  # Generated by 01_clean.py
│   └── panel_ikt.csv                # Main estimation sample (13,723 obs)
├── results/                         # Tables, figures, manifests
│   ├── tables/                      # CSV exports
│   └── runs/                        # JSON run manifests
├── logs/                            # Execution logs
├── tests/                           # pytest suite
├── quality_reports/                 # Plans, session logs, reviews
│   └── plans/                       # Saved plans (survive compression)
├── work plans and summary/          # Methods summaries per section
├── explorations/                    # Research sandbox (fast-track rules)
├── master_supporting_docs/          # Reference papers and slides
├── scripts/                         # Utility scripts
└── templates/                       # Session log, quality report templates
```

---

## Commands

```powershell
# Python pipeline (Technology conda env)
set PYTHONIOENCODING=utf-8 && conda run -n Technology python src/py/01_clean.py
set PYTHONIOENCODING=utf-8 && conda run -n Technology python src/py/03_table_II_summary_stats.py
set PYTHONIOENCODING=utf-8 && conda run -n Technology python src/py/04b_figure_IIIB_techpush_demandpull.py
set PYTHONIOENCODING=utf-8 && conda run -n Technology python src/py/05_figure_II_time_series.py
set PYTHONIOENCODING=utf-8 && conda run -n Technology python src/py/06_table_IVB_spillover.py
set PYTHONIOENCODING=utf-8 && conda run -n Technology python src/py/07_table_IVC_dynamics.py

# Stata pipeline
& $env:STATA_EXE /e do "src/stata/01_setup.do"
& $env:STATA_EXE /e do "src/stata/02_tableV_variance.do"

# Tests
conda run -n Technology pytest -q tests/

# LaTeX (local verification -- main editing is on Overleaf)
cd Overleaf && pdflatex -interaction=nonstopmode main.tex && bibtex main && pdflatex main.tex && pdflatex main.tex
```

---

## Quality Thresholds

| Score | Gate | Meaning |
|-------|------|---------|
| 80 | Commit | Good enough to save |
| 90 | PR | Ready for co-author review |
| 95 | Excellence | Publication-ready |

One **critical** finding → automatic fail regardless of score.

---

## Skills Quick Reference

| Command | What It Does |
|---------|-------------|
| `/compile-latex [file]` | pdflatex 3-pass + bibtex |
| `/run-python [step]` | Run Python pipeline step in Technology env |
| `/run-stata [step]` | Run Stata do-file |
| `/proofread [file]` | Grammar/typo/notation review |
| `/review-paper [file]` | Full manuscript review (referee-style) |
| `/review-python [file]` | Python code quality review |
| `/review-stata [file]` | Stata code quality review |
| `/data-analysis [goal]` | End-to-end Python analysis |
| `/devils-advocate` | Challenge identification strategy |
| `/write-section` | Draft a paper section from structural notes |
| `/lit-review [topic]` | Literature search + synthesis |
| `/research-ideation [topic]` | Research questions + strategies |
| `/interview-me [topic]` | Interactive research interview |
| `/commit [msg]` | Stage, commit, push |

---

## Paper Structure (Sections I–VII)

| Section | Title | Key Content | Status |
|---------|-------|-------------|--------|
| I | Introduction | Motivation, 4 findings, contribution, caveats | **Drafted** |
| II | Data and Measurement | Corpus, LLM pipeline, TNT-LLM taxonomy, panel | II.D drafted; II.A–C, II.E notes |
| III | Validation | Face validity, cross-tech, time-series, proxies, error | III.A–C **drafted**; III.D–E notes |
| IV | Structure of Beliefs | Variance decomposition, spillover, dynamics | IV.A–C **drafted**; IV.D notes |
| V | Beliefs and Firm Actions | Growth vs efficiency, cause-side, disagreement | Notes only |
| VI | Beliefs and Misallocation | Ex post benchmarking, transfer, aggregate cycles | Notes only |
| VII | Conclusion | Summary, caveats, future research | Notes only |

### Tables (current)

| Label | Content | Source script | Section |
|-------|---------|--------------|---------|
| Table I | Macro-category definitions & span counts | — (manual) | II.C |
| Table II | Summary statistics | `03_table_II_summary_stats.py` | II.D |
| Table V | Variance decomposition (firm = 60–74%) | `02_tableV_variance.do` | IV.A |
| Table VI | Cross-technology belief spillover | `06_table_IVB_spillover.py` | IV.B |
| Table VII | Belief persistence by tenure horizon | `07_table_IVC_dynamics.py` | IV.C |
| App. | Spillover robustness & by-category | `06_table_IVB_spillover.py` | IV.B |

### Figures (current)

| Label | Content | Source script | Section |
|-------|---------|--------------|---------|
| Figure I | Cross-tech macro-share bars (A: cause, B: effect) | — (external) | III.B |
| Figure II | Tech-push vs demand-pull scatter | `04b_figure_IIIB_techpush_demandpull.py` | III.B |
| Figure III | Time-series discussion intensity (6 techs) | `05_figure_II_time_series.py` | III.C |
| Figure IV | Belief persistence decay curve | `07_table_IVC_dynamics.py` | IV.C |
| App. | Per-tech cause/effect time series | — (external) | III.B |

---

## Key Empirical Facts

| Fact | Source |
|------|--------|
| 450,095 earnings calls, 19,469 firms, 94 countries, 2002–2024 | Refinitiv Eikon |
| 29 disruptive technologies | Kalyani et al. (2025, QJE) |
| 187,647 causal snippets → 197,818 cause spans + 385,418 effect spans | LLM extraction |
| 5 macro cause + 5 macro effect categories | TNT-LLM taxonomy |
| Estimation sample: 13,723 obs, 2,812 firms, 29 techs, 92 qtrs, 42 countries | panel_ikt.csv |
| Firm-level variation = 60–74% of total | Table V (variance decomp) |
| Effect beliefs more portable across technologies than cause beliefs | Table VI (spillover β: 0.39 effect vs 0.27 cause) |
| Initial beliefs predict current beliefs years later (β = 0.15–0.17 overall) | Table VII (persistence) |
| 20 of 26 technologies are technology-push dominant | Figure II (scatter) |
| CER lifecycle hypothesis rejected (flat across tenure) | Exploration analysis |

---

## Macro Taxonomy (5 + 5)

### Cause categories
| # | Category | Variable |
|---|----------|----------|
| 1 | Technology Innovation and Advancement | `share_cause_1` |
| 2 | Market Demand and Consumer Behavior | `share_cause_2` |
| 3 | Regulatory and Policy Drivers | `share_cause_3` |
| 4 | Strategic Partnerships and Investment | `share_cause_4` |
| 5 | Cost and Economic Viability | `share_cause_5` |

### Effect categories
| # | Category | Variable |
|---|----------|----------|
| 1 | Revenue and Financial Growth | `share_effect_1` |
| 2 | Cost Reduction and Efficiency | `share_effect_2` |
| 3 | Market Expansion and Adoption | `share_effect_3` |
| 4 | Product and Service Innovation | `share_effect_4` |
| 5 | Operational Efficiency and Automation | `share_effect_5` |

---

## Notation & Variable Conventions

| Symbol | Meaning | Introduced |
|--------|---------|------------|
| $s^{\text{cause}}_{ikt,c}$ | Share of macro-cause category $c$ for firm $i$, tech $k$, quarter $t$ | Sec II.D (Eq. 1) |
| $s^{\text{effect}}_{ikt,c}$ | Share of macro-effect category $c$ | Sec II.D |
| $\alpha_i$, $\gamma_{kt}$, $\mu_{st}$ | Firm, tech×time, industry×time fixed effects | Sec IV |
| Spillover (Eq. 2) | $s_{ik't,c} = \beta \cdot \bar{s}_{i(-k')t,c} + \gamma_{k' \times c} + \delta_{t \times c} + \varepsilon$ | Sec IV.B |
| Persistence (Eq. 3) | $s_{ikt,c} = \beta \cdot s_{ik0,c} + \gamma_{k \times c} + \delta_{t \times c} + \varepsilon$ | Sec IV.C |
| Growth orientation | Revenue Growth + Market Expansion + Product Innovation share | Sec V.A (planned) |
| Efficiency orientation | Cost Reduction + Operational Efficiency share | Sec V.A (planned) |
| Disagreement | Distance between manager and analyst cause/effect vectors | Sec II.E (planned) |

---

## Non-Negotiables

- Raw data in `data/` is **read-only** — never overwrite
- All Python scripts use repo-relative paths via `Path(__file__).resolve().parents[2]`
- Deterministic seeds (`SEED = 42`) set once at top
- Every pipeline run writes a JSON manifest to `results/runs/`
- Stata do-files: `version 19.5`, `set more off`, log to `logs/`
- Tables exported as both `.csv` and `.tex`
- Figures saved as `.pdf` and `.png` to `Overleaf/Figures/`
- Stacked regressions use pyhdfe + statsmodels with firm-clustered SEs
- All figure/table floats go in `allfigures.tex` / `alltables.tex`, not inline in `main.tex`

---

## Preferences

**Visual:** Publication-quality (JF/QJE style). White background. Matplotlib with serif fonts. No default colors. Muted blue/red palette.
**Reporting:** Concise bullets. Details on request.
**Session logs:** Always (post-plan, incremental, end-of-session).
**Replication:** Strict. Flag any tolerance exceedance.

---

## Exploration Mode

For experimental work, use the **Fast-Track** workflow:
- Work in `explorations/` folder
- 60/100 quality threshold (vs. 80/100 for production)
- No plan needed — just a research value check
- See `.claude/rules/exploration-fast-track.md`

---

## Next Steps (as of 2026-02-13)

1. **Section V** requires firm-level outcome data (Compustat, CRSP, I/B/E/S) merged via gvkey
2. **Section III.D** (external proxies) and **III.E** (measurement error) need additional data
3. **Section IV.D** (manager-analyst disagreement) needs speaker-identified spans
4. **Sections II.A–C, II.E** prose still needs drafting
5. **Section VI** (misallocation) requires ex post benchmarks and performance data
